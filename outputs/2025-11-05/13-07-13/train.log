[2025-11-05 13:07:13,816][root][INFO] - Using config:
seed: 0
device: cuda:0
resume_path: null
model:
  text_embed_model_string: t5-small
  image_embed_model_string: stabilityai/sd-vae-ft-mse
  embedding_dim: 768
  time_embedding_dim: 256
  text_embedding_dim: 512
  n_image_tokens: 64
  n_text_tokens: 128
  n_blocks: 12
  n_heads: 12
  expansion_factor: 4
  latent_channels: 4
  vae_scale_factor: 0.18215
  patch_embed_init: 0.02
  final_layer_init_gain: 0.02
  text_max_length: 128
training:
  learning_rate: 0.0005
  weight_decay: 0.1
  batch_size: 128
  num_steps: 100000
  warmup_ratio: 0.05
  lr_decay_ratio: 0.1
  gradient_clip_max_norm: 1.0
  gradient_accumulation_steps: 1
dataset:
  dataset_name: jackyhate/text-to-image-2M
  dataset_path: data/text-to-image-2M_64x64/
  dataset_pattern: data/text-to-image-2M_64x64_preprocessed-%06d.tar
  num_datapoints: 2300793
  train_dataset_pattern: data/text-to-image-2M_64x64_preprocessed-{000001..000230}.tar
  eval_dataset_pattern: data/text-to-image-2M_64x64_preprocessed-000000.tar
  eval_samples: 32
  dataset_size: null
  include_text_embedder: false
  image_size: 64
  num_workers: 8
  prefetch_batches: 4
  shuffle_buffer_size: 100
logging:
  eval_every: 500
  num_inference_steps: 50
  log_every: 100
  use_wandb: true
  wandb_project: diffusion-transformer
  num_images_to_upload: 32
distributed:
  distributed: true
  world_size: 2
  backend: nccl
  master_addr: localhost
  master_port: '12355'
checkpoint:
  save_checkpoints: true
  checkpoint_freq: 500
  checkpoint_dir: checkpoints
  keep_recent_checkpoints: 5
  keep_checkpoint_every_n_steps: 2500
experiment: debug

[2025-11-05 13:07:13,817][root][INFO] - Rank 0/1, Local rank: 0
